<html>
	<head>
		<meta name="viewport" content="width=device-width, initial-scale=1" />
		<script src="https://aframe.io/releases/1.5.0/aframe.min.js"></script>
		<script src="https://cdn.jsdelivr.net/npm/mind-ar@1.2.5/dist/mindar-image-aframe.prod.js"></script>
	</head>
	<body>
		<a-scene
			mindar-image="imageTargetSrc: ./targets.mind; filterMinCF: 0.0001; filterBeta: 0.001; uiError: no; uiLoading: no; uiScanning: no;"
			vr-mode-ui="enabled: false"
			device-orientation-permission-ui="enabled: false"
		>
			<a-assets>
				<video id="video" src="videos/IMG_0150.mp4"></video>
			</a-assets>
			<a-camera position="0 0 0" look-controls="enabled: false"></a-camera>
			<a-video
				id="video-entity"
				src="#video"
				position="0 1.6 -2"
				height="3"
				width="4"
				rotation="0 0 0"
				visible="false"
			></a-video>
		</a-scene>

		<script>
			document.addEventListener("DOMContentLoaded", function () {
				const video = document.querySelector("#video");
				const videoEntity = document.querySelector("#video-entity");
				const scene = document.querySelector("a-scene");
				const target = document.querySelector("[mindar-image-target]");

				scene.addEventListener("loaded", (event) => {
					console.log("Scene loaded");
				});

				scene.addEventListener("arReady", (event) => {
					console.log("MindAR is ready");
				});

				scene.addEventListener("arError", (event) => {
					console.error("AR Error: ", event);
				});

				target.addEventListener("targetFound", (event) => {
					console.log("Target found");
					videoEntity.setAttribute("visible", "true");
					video.play();
				});

				video.addEventListener("ended", (event) => {
					console.log("Video ended");
					videoEntity.setAttribute("visible", "false");
				});
			});
		</script>
	</body>
</html>
